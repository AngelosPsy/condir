#' Report results of conditioning data
#'
#' @description Report results of data analyses run with the \code{csCompare}.
#' @param csCompareObj a list or data frame returned from
#' the \code{csCompare} function.
#' @param csSensitivityObj Sensitivity analysis results returned from the
#' \code{csSensitivity} function
#' @param save If \code{code} argument is set to \code{FALSE} (default), the
#' results are printed on the sceen. Otherwise, a '.txt' file with the
#' report is generated.
#' @param fileName The file name of the produced report. The argument is
#' ignored if \code{save} is set to \code{FALSE}.
#' @param alphalevel The alpha level to be used for determining significant
#' or non-significant results.
#' @examples
#' tmp <- csCompare(cs1 = c(1, 2, 3, 1, 4), cs2 = c(10, 12, 12, 31, 13))
#' csReport(tmp)
#' @export
csReport <- function(csCompareObj = NULL, csSensitivityObj = NULL, save = FALSE, fileName = "report", alphalevel = 0.05) {

  if (base::is.null(csCompareObj) && base::is.null(csSensitivityObj)){
    rep <- "[No report was produced.]"
  }

  if (!base::is.null(csCompareObj)){
    # Check whether the csCompareObj has been generated by
    # the csCompare function.
    if (!base::is.list(csCompareObj)){
      stop("The csCompareObj has not been generated
           with the csCompare function.")
    } else {

      # Report frequentist results
      repF <- paste0("We perfromed a ",
                     csCompareObj$freq.results[["alternative"]], " ",
                     csCompareObj$freq.results[["method"]],
                     ". The results of the t-test are t (",
                     base::round(as.numeric(as.character(
                       csCompareObj$freq.results[["df"]])), 3),
                     ") = ",
                     base::round(as.numeric(as.character(
                       csCompareObj$freq.results[["t.statistic"]])), 3),
                     ", p = ",
                     base::round(as.numeric(as.character(
                       csCompareObj$freq.results[["p.value"]])), 3),
                     ".")
      # Report whethere there are significant or non-significant results
      paired <- base::ifelse(base::as.character(csCompareObj$freq.results[["method"]]) == "Paired t-test", TRUE, FALSE)
      p.val <- as.numeric(as.character(csCompareObj$freq.results[["p.value"]]))
      if (paired && p.val < alphalevel){
        inter <- base::paste0("Those results suggest that there are statistically significant differences between cs1 and cs2,
                              for an alpha level of ", alphalevel, ".")
      } else if (paired && p.val >= alphalevel){
        inter <- base::paste0("Those results suggest that there are no statistically significant differences between cs1 and cs2,
                              for an alpha level of ", alphalevel, ".")
      } else if (!paired && p.val < alphalevel){
        inter <- base::paste0("Those results suggest that there are statistically significant between group differences,
                              for an alpha level of ", alphalevel, ".")
      } else if (!paired && p.val >= alphalevel){
        inter <- base::paste0("Those results suggest that there are no statistically significant between group differences,
                              for an alpha level of ", alphalevel, ".")
      }

      repF <- paste(repF, inter, sep = "\n\n")

      # Report Bayesian results
      repB <- paste0("\n\nWe perfromed a ",
                     csCompareObj$freq.results[["alternative"]],
                     " Bayesian t-test, with a Catchy prior, with its width set to ",
                     csCompareObj$bayes.results[["rscale"]],
                     ". The BF10 was equal to BF10 = ",
                     base::round(base::as.numeric(
                       base::as.character(
                         csCompareObj$bayes.results[["bf10"]])), 2),
                     ". The BF01 was equal to BF01 = ",
                     base::round(base::as.numeric(
                       base::as.character(
                         csCompareObj$bayes.results[["bf01"]])), 2),
                     ".")


      bf10 <- csCompareObj$bayes.results[["bf10"]]
      bf01 <- csCompareObj$bayes.results[["bf01"]]

      # Determine level of evidence for bf10
      if (bf10 > 0 && bf10 < 1){
        interbf10 <- "The results suggest that there is no evidence for H1, relative to H0."
      } else if (bf10 >= 1 && bf10 < 3){
        interbf10 <- "The results suggest that there is anecdotal evidence for H1, relative to H0."
      } else if (bf10 >= 3 && bf10 < 10){
        interbf10 <- "The results suggest that there is substantial evidence for H1, relative to H0."
      } else if (bf10 >= 10 && bf10 < 30){
        interbf10 <- "The results suggest that there is strong evidence for H1, relative to H0."
      }  else if (bf10 >= 30 && bf10 < 100){
        interbf10 <- "The results suggest that there is very strong evidence for H1, relative to H0."
      }  else if (bf10 > 100){
        interbf10 <- "The results suggest that there is decisive evidence for H1, relative to H0."
      }

      # Determine level of evidence for bf01
      if (bf01 > 0 && bf01 < 1){
        interbf01 <- "The results suggest that there is no evidence for H0, relative to H1."
      } else if (bf01 >= 1 && bf10 < 3){
        interbf01 <- "The results suggest that there is anecdotal evidence for H0, relative to H1."
      } else if (bf01 >= 3 && bf01 < 10){
        interbf01 <- "The results suggest that there is substantial evidence for H0, relative to H1."
      } else if (bf01 >= 10 && bf01 < 30){
        interbf01 <- "The results suggest that there is strong evidence for H0, relative to H1."
      }  else if (bf01 >= 30 && bf01 < 100){
        interbf01 <- "The results suggest that there is very strong evidence for H0, relative to H1."
      }  else if (bf01 > 100){
        interbf01 <- "The results suggest that there is decisive evidence for H0, relative to H1."
      }

      repB <- paste(repB, interbf10, interbf01, sep = "\n\n")
      rep <- paste(repF, repB, collapse = " ")

      }
  }
  if (!base::is.null(csSensitivityObj)){
    # Check whether the csSensitivityObj has been generated by
    # the csSensitivity function.
    if (!base::is.list(csSensitivityObj)){
      stop("The csSensitivityObj has not been generated
           with the csSensitivity function.")
    } else {
      # Report Sensitivity analysis results
      repB <- paste0("We perfromed a Sensitivity Analysis using the scaling factors: ",
                     paste(csSensitivityObj$rscale, collapse = ", "),
                     ". The results for BF01 were: ",
                     paste(round(as.numeric(
                       as.character(csSensitivityObj$bf01)), 2),
                       collapse = ", "), " respectively.",
                     " The results for BF10 were: ",
                     paste(round(as.numeric
                                 (as.character(csSensitivityObj$bf10)), 2),
                           collapse = ", "), " respectively.")
    }
    rep <- paste(repB, collapse = " ")
  }
  # Save file if that is asked, otherwise print the results on screen.
  if (save){
    base::cat(rep, file = base::paste0(fileName, ".txt"))
  } else{
    base::cat(rep)
  }
}
